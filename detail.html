<!doctype html>
<html>

	<head>
		<meta charset="utf-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="css/mui.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="css/detail.css"/>
		<link rel="stylesheet" type="text/css" href="css/common.css"/>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">查找结果</h1>
		</header>
		<section>
			<h1>匹配结果</h1>
			<div class="detail-title"></div>
			<div class="result">
				<p>你要找的可能是</p>
				<ul class="mui-table-view" id="result-ul"></ul>
			</div>
		</section>
	</body>
<script src="js/mui.js"></script>
<script src="js/flexible.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
	mui.init()
	mui.plusReady(function () {
		var title = decodeURI(plus.webview.currentWebview().title);
		mui.ajax('http://apis.juhe.cn/rubbish/search',{
			data:{
				key:'dfe7a5dc90a9be32d35d15d5a06eb619',
				q:title
			},
			success:function(data){
				var result = data.result;
				var flag = false;
				//判断是否存在垃圾
				if(!result){
					mui('.detail-title')[0].innerHTML=`
						<p>"${title}"貌似不是垃圾哦,再试试吧^^</p>
						<h3>Σ(っ °Д °;)っ</h3>
					`;
					mui('.result')[0].innerHTML=``;
					return false;
				}		
				mui.each(result,function(index,item){
					//找到垃圾，排出本身
					if(item.itemName == title){
						mui('.detail-title')[0].innerHTML = `
							<p>${item.itemName}为</p>
							<h3>${item.itemCategory}</h3>
						`;
						flag = true;
					}else{
						mui('#result-ul')[0].innerHTML += `
						<li class="mui-table-view-cell">
							<a class="mui-navigate-right">
								 <p>${item.itemName}</p>
								 <p>${item.itemCategory}</p>
							</a>
						</li>
						`;
					}
				});
				if(!flag){
					mui('.detail-title')[0].innerHTML = `
						<p>为您找到了与"${title}"相关的垃圾</p>
					`;
				}
				
			},
		})
	})
</script>
</html>
